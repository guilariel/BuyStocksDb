--
-- PostgreSQL database dump
--

-- Dumped from database version 17.5
-- Dumped by pg_dump version 17.5

-- Started on 2025-12-18 23:39:44

SET statement_timeout = 0;
SET lock_timeout = 0;
SET idle_in_transaction_session_timeout = 0;
SET transaction_timeout = 0;
SET client_encoding = 'UTF8';
SET standard_conforming_strings = on;
SELECT pg_catalog.set_config('search_path', '', false);
SET check_function_bodies = false;
SET xmloption = content;
SET client_min_messages = warning;
SET row_security = off;

SET default_tablespace = '';

SET default_table_access_method = heap;

--
-- TOC entry 225 (class 1259 OID 83926)
-- Name: in_possession; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.in_possession (
    owner_id bigint NOT NULL,
    stock_id bigint NOT NULL,
    amount bigint NOT NULL,
    CONSTRAINT in_possession_amount_check CHECK ((amount > 0))
);


ALTER TABLE public.in_possession OWNER TO postgres;

--
-- TOC entry 219 (class 1259 OID 83517)
-- Name: price_history; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.price_history (
    stock_id integer NOT NULL,
    price integer NOT NULL,
    currency text NOT NULL,
    date timestamp without time zone NOT NULL,
    CONSTRAINT price_history_currency_check CHECK ((currency = ANY (ARRAY['USD'::text, 'ARS'::text, 'EUR'::text])))
);


ALTER TABLE public.price_history OWNER TO postgres;

--
-- TOC entry 218 (class 1259 OID 83455)
-- Name: stock; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.stock (
    id integer NOT NULL,
    symbol text NOT NULL,
    name text NOT NULL,
    description text NOT NULL
);


ALTER TABLE public.stock OWNER TO postgres;

--
-- TOC entry 217 (class 1259 OID 83454)
-- Name: stock_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

ALTER TABLE public.stock ALTER COLUMN id ADD GENERATED ALWAYS AS IDENTITY (
    SEQUENCE NAME public.stock_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- TOC entry 224 (class 1259 OID 83813)
-- Name: transaction_history; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.transaction_history (
    id integer NOT NULL,
    owner_id integer NOT NULL,
    stock_id integer NOT NULL,
    amount integer NOT NULL,
    price integer NOT NULL,
    currency text NOT NULL,
    date timestamp without time zone NOT NULL,
    type text NOT NULL,
    CONSTRAINT transaction_history_amount_check CHECK ((amount > 0)),
    CONSTRAINT transaction_history_currency_check CHECK ((currency = ANY (ARRAY['USD'::text, 'ARS'::text, 'EUR'::text]))),
    CONSTRAINT transaction_history_price_check CHECK ((price > 0)),
    CONSTRAINT transaction_history_type_check CHECK ((type = ANY (ARRAY['buy'::text, 'sell'::text])))
);


ALTER TABLE public.transaction_history OWNER TO postgres;

--
-- TOC entry 223 (class 1259 OID 83812)
-- Name: transaction_history_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

ALTER TABLE public.transaction_history ALTER COLUMN id ADD GENERATED ALWAYS AS IDENTITY (
    SEQUENCE NAME public.transaction_history_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- TOC entry 222 (class 1259 OID 83549)
-- Name: user_funds; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.user_funds (
    user_id integer NOT NULL,
    funds integer,
    currency text NOT NULL,
    CONSTRAINT user_funds_currency_check CHECK ((currency = ANY (ARRAY['USD'::text, 'ARS'::text, 'EUR'::text])))
);


ALTER TABLE public.user_funds OWNER TO postgres;

--
-- TOC entry 221 (class 1259 OID 83542)
-- Name: users; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.users (
    id integer NOT NULL,
    name text NOT NULL,
    password_hash text NOT NULL
);


ALTER TABLE public.users OWNER TO postgres;

--
-- TOC entry 220 (class 1259 OID 83541)
-- Name: users_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

ALTER TABLE public.users ALTER COLUMN id ADD GENERATED ALWAYS AS IDENTITY (
    SEQUENCE NAME public.users_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- TOC entry 4841 (class 0 OID 83926)
-- Dependencies: 225
-- Data for Name: in_possession; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.in_possession (owner_id, stock_id, amount) FROM stdin;
\.


--
-- TOC entry 4835 (class 0 OID 83517)
-- Dependencies: 219
-- Data for Name: price_history; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.price_history (stock_id, price, currency, date) FROM stdin;
\.


--
-- TOC entry 4834 (class 0 OID 83455)
-- Dependencies: 218
-- Data for Name: stock; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.stock (id, symbol, name, description) FROM stdin;
\.


--
-- TOC entry 4840 (class 0 OID 83813)
-- Dependencies: 224
-- Data for Name: transaction_history; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.transaction_history (id, owner_id, stock_id, amount, price, currency, date, type) FROM stdin;
\.


--
-- TOC entry 4838 (class 0 OID 83549)
-- Dependencies: 222
-- Data for Name: user_funds; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.user_funds (user_id, funds, currency) FROM stdin;
\.


--
-- TOC entry 4837 (class 0 OID 83542)
-- Dependencies: 221
-- Data for Name: users; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.users (id, name, password_hash) FROM stdin;
\.


--
-- TOC entry 4847 (class 0 OID 0)
-- Dependencies: 217
-- Name: stock_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.stock_id_seq', 1, false);


--
-- TOC entry 4848 (class 0 OID 0)
-- Dependencies: 223
-- Name: transaction_history_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.transaction_history_id_seq', 1, false);


--
-- TOC entry 4849 (class 0 OID 0)
-- Dependencies: 220
-- Name: users_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.users_id_seq', 1, false);


--
-- TOC entry 4681 (class 2606 OID 83931)
-- Name: in_possession in_possession_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.in_possession
    ADD CONSTRAINT in_possession_pkey PRIMARY KEY (owner_id, stock_id);


--
-- TOC entry 4673 (class 2606 OID 83524)
-- Name: price_history price_history_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.price_history
    ADD CONSTRAINT price_history_pkey PRIMARY KEY (stock_id, date);


--
-- TOC entry 4671 (class 2606 OID 83461)
-- Name: stock stock_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.stock
    ADD CONSTRAINT stock_pkey PRIMARY KEY (id);


--
-- TOC entry 4679 (class 2606 OID 83823)
-- Name: transaction_history transaction_history_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.transaction_history
    ADD CONSTRAINT transaction_history_pkey PRIMARY KEY (id);


--
-- TOC entry 4677 (class 2606 OID 83556)
-- Name: user_funds user_funds_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.user_funds
    ADD CONSTRAINT user_funds_pkey PRIMARY KEY (user_id, currency);


--
-- TOC entry 4675 (class 2606 OID 83548)
-- Name: users users_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.users
    ADD CONSTRAINT users_pkey PRIMARY KEY (id);


--
-- TOC entry 4686 (class 2606 OID 83932)
-- Name: in_possession fk_inpossession_stock; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.in_possession
    ADD CONSTRAINT fk_inpossession_stock FOREIGN KEY (stock_id) REFERENCES public.stock(id) ON DELETE CASCADE;


--
-- TOC entry 4687 (class 2606 OID 83937)
-- Name: in_possession fk_inpossession_user; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.in_possession
    ADD CONSTRAINT fk_inpossession_user FOREIGN KEY (owner_id) REFERENCES public.users(id);


--
-- TOC entry 4684 (class 2606 OID 83824)
-- Name: transaction_history fk_transaction_history_stock; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.transaction_history
    ADD CONSTRAINT fk_transaction_history_stock FOREIGN KEY (stock_id) REFERENCES public.stock(id) ON DELETE CASCADE;


--
-- TOC entry 4685 (class 2606 OID 83829)
-- Name: transaction_history fk_transaction_history_user; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.transaction_history
    ADD CONSTRAINT fk_transaction_history_user FOREIGN KEY (owner_id) REFERENCES public.users(id);


--
-- TOC entry 4682 (class 2606 OID 83525)
-- Name: price_history price_history_stock_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.price_history
    ADD CONSTRAINT price_history_stock_id_fkey FOREIGN KEY (stock_id) REFERENCES public.stock(id);


--
-- TOC entry 4683 (class 2606 OID 83557)
-- Name: user_funds user_funds_user_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.user_funds
    ADD CONSTRAINT user_funds_user_id_fkey FOREIGN KEY (user_id) REFERENCES public.users(id);


-- Completed on 2025-12-18 23:39:44

--
-- PostgreSQL database dump complete
--

